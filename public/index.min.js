"use strict";let map;const mapZoomLevel=15,geofences=new Map;async function initMap(){getUserLocation().then(e=>{map=new google.maps.Map(document.getElementById("map"),{center:e,zoom:mapZoomLevel,mapTypeId:google.maps.MapTypeId.ROADMAP}),new google.maps.Marker({position:e,label:{text:"You are here",className:"marker-label"},map:map}),geofences.forEach(e=>{var t=getRandomColor();new google.maps.Polygon({paths:e,strokeColor:t,strokeOpacity:.8,strokeWeight:2,fillColor:t,fillOpacity:.35,map:map})})})}async function getUserLocation(){return new Promise((t,o)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{e={lat:e.coords.latitude,lng:e.coords.longitude};t(e)},e=>{o(e)}):o("Geolocation is not supported by this browser.")})}function getRandomColor(){let t="#";for(let e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}function isWithinGeofence(o){let n=!1;return geofences.forEach((e,t)=>{n||(console.info("checking if user is in region: "+t),n=google.maps.geometry.poly.containsLocation(o,new google.maps.Polygon({paths:e})))}),n}function handleButtonClick(){const t=document.getElementById("success-message"),o=(t?.classList.add("hidden"),document.getElementById("error-message"));o?.classList.add("hidden"),getUserLocation().then(e=>{(isWithinGeofence(e)?t:o)?.classList.remove("hidden")}).catch(e=>{console.error("Error fetching user location:",e)})}function setIPFromCloudflare(){fetch("https://www.cloudflare.com/cdn-cgi/trace").then(e=>{e.text().then(e=>{var e=e.split("\n")[2].split("=")[1],t=document.getElementById("ip"),t=(t&&(t.innerText=e),document.getElementById("ip-outer"));t&&t.classList.remove("hidden")})}).catch(e=>{console.error("Failed to fetch the users IP",{error:e});e=document.getElementById("ip-fail");e&&e.classList.remove("hidden")})}geofences.set("Alaska",[{lng:-149.9041557,lat:61.2190324},{lng:-149.8588371,lat:61.2187845},{lng:-149.8542023,lat:61.1877758},{lng:-149.9093056,lat:61.1876103},{lng:-149.9041557,lat:61.2190324}]),geofences.set("Chico",[{lng:-121.8198209,lat:39.7573026},{lng:-121.8141542,lat:39.7574181},{lng:-121.8140566,lat:39.7553479},{lng:-121.8198316,lat:39.7551829},{lng:-121.8198209,lat:39.7573026}]),geofences.set("Paradise",[{lng:-121.597248,lat:39.7652903},{lng:-121.5960254,lat:39.7652861},{lng:-121.5959772,lat:39.7642821},{lng:-121.5972293,lat:39.7643151},{lng:-121.597248,lat:39.7652903}]),document.getElementById("button")?.addEventListener("click",()=>{handleButtonClick()}),window.initMap=initMap,setIPFromCloudflare();